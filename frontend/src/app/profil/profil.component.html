@if(showProfile){


<div class="profileDiv">

<h1 class="ms-3"><strong class="ms-2">{{ userName }}</strong> rendelési adatok </h1>
<form [formGroup]="userDataForm" class="ms-3 mt-3">

    <div class="form-group">
        <span class="input-group-text ms-1" style="max-width: 300px;">Felhasználónév</span>
        <input type="text" formControlName="name" class="form-control mb-4 ms-1" readonly style="max-width: 300px;">
    </div>
<!--csak akkor adjuk hozzá az is-invalid osztályt hogyha a : utáni feltétel igaz. Vagyis hogy .invalid: nem ment át a Validáción és .touched már megérintette majd elhagyta.-->
<!--Tehát az is-invalid classt csak akkor adjuk hozzá, amikor ez a 2 feltétel teljesül.-->
<!--Ha még nem szerkesztették, vagy még nem értek hozzá, akkor mindkét feltétel false. Nem történik semmi.
<!-Nem kap is-invalid osztályt, tehát nincs piros keret-->
<!--Ha a felhasználó beleír egy betűt majd kilép a mezőből, akkor mindkettő true lesz, vagyis az input megkapja az is-invalid osztályt?-->
<!--A Bootstrap az is-invalid osztályt használja a hibás mezők stílusozására (piros keret, piros szöveg stb.).-->
<!--DIV -nél, IF-ben ugyanez, ugyanazok a feltételek, a szöveg miatt kell újra ellenőrizni-->
    <div class="form-group">
        <span class="input-group-text ms-1" style="max-width: 300px;">Keresztnév</span>
        <input type="text" formControlName="first_name" class="form-control mb-4 ms-1"  style="max-width: 300px;"
            [ngClass]="{'is-invalid': userDataForm.controls['first_name'].invalid && userDataForm.controls['first_name'].touched}">
            @if(userDataForm.controls['first_name'].invalid && userDataForm.controls['first_name'].touched){
                <div class="invalid-feedback ms-1">
                    A keresztnév megadása kötelező!
                </div>
            }
        </div>

    <div class="form-group">
        <span class="input-group-text ms-1" style="max-width: 300px;">Vezetéknév</span>
        <input type="text" formControlName="last_name" class="form-control mb-4 ms-1" style="max-width: 300px;"
        [ngClass]="{'is-invalid': userDataForm.controls['last_name'].invalid && userDataForm.controls['last_name'].touched}">
        @if(userDataForm.controls['last_name'].invalid && userDataForm.controls['last_name'].touched){
            <div class="invalid-feedback ms-1">
                A vezetéknév megadása kötelező
                </div>
        }
    </div>

    <div class="form-group">
        <span class="input-group-text ms-1" style="max-width: 300px;">Születési dátum</span>
        <input type="date" [min]="'1900-01-01'" [max]="'2100-12-31'" formControlName="birth_date" class="form-control mb-4 ms-1" style="max-width: 300px;"
        [ngClass]="{'is-invalid': userDataForm.controls['birth_date'].invalid && userDataForm.controls['birth_date'].touched}">
        @if (userDataForm.controls['birth_date'].invalid && userDataForm.controls['birth_date'].touched) {
            <div class="invalid-feedback ms-1">
                A születési dátum megadása kötelező
            </div>
        }
    </div>

    <div class="form-group">
        <span class="input-group-text ms-1" style="max-width: 300px;">Telefonszám (+36)</span>
        <input type="tel" formControlName="phone_number" class="form-control mb-4 ms-1" style="max-width: 300px;"
        [ngClass]="{'is-invalid': userDataForm.controls['phone_number'].invalid && userDataForm.controls['phone_number'].touched}">
        @if(userDataForm.controls['phone_number'].invalid && userDataForm.controls['phone_number'].touched){
            <div class="invalid-feedback ms-1">
                Telefonszám megadása kötelező
            </div>
        }
    </div>

    <div class="form-group">
        <span class="input-group-text ms-1" style="max-width: 300px;">irányítószám</span>
        <input type="number" formControlName="postal_code" class="form-control mb-4 ms-1" style="max-width: 300px;"
        [ngClass]="{'is-invalid': userDataForm.controls['postal_code'].invalid && userDataForm.controls['postal_code'].touched}">
        @if(userDataForm.controls['postal_code'].invalid && userDataForm.controls['postal_code'].touched){
            <div class="invalid-feedback ms-1">
                Irányítószám megadása kötelező
            </div>
        }
    </div>

    <div class="form-group">
        <span class="input-group-text ms-1" style="max-width: 300px;">Város</span>
        <input type="text" formControlName="city" class="form-control mb-4 ms-1" style="max-width: 300px;"
        [ngClass]="{'is-invalid': userDataForm.controls['city'].invalid && userDataForm.controls['city'].touched}">
        @if (userDataForm.controls['city'].invalid && userDataForm.controls['city'].touched) {
            <div class="invalid-feedback ms-1">
                Város megadása kötelező
            </div>
        }
    </div>

    <div class="form-group">
        <span class="input-group-text ms-1" style="max-width: 300px;">Közterület neve / jellege (pl. Üllői út)</span>
        <input type="text" formControlName="street" class="form-control mb-4 ms-1" style="max-width: 300px;"
        [ngClass]="{'is-invalid': userDataForm.controls['street'].invalid && userDataForm.controls['street'].touched}">
        @if (userDataForm.controls['street'].invalid && userDataForm.controls['street'].touched) {
            <div class="invalid-feedback ms-1">
                Közterület megadása kötelező
            </div>
        }
    </div>

    <div class="form-group">
        <span class="input-group-text ms-1" style="max-width: 300px;">Házszám</span>
        <input type="text" formControlName="house_number" class="form-control mb-4 ms-1" style="max-width: 300px;"
        [ngClass]="{'is-invalid': userDataForm.controls['house_number'].invalid && userDataForm.controls['house_number'].touched}">
        @if (userDataForm.controls['house_number'].invalid && userDataForm.controls['house_number'].touched) {
            <div class="invalid-feedback ms-1">
                Házszám megadása kötelező
            </div>
        }
    </div>
    <div class="form-group">
        <span class="input-group-text ms-1" style="max-width: 300px;">Emelet</span>
        <input type="text" formControlName="floor" class="form-control mb-4 ms-1" style="max-width: 300px;">
    </div>

    <div class="form-group">
        <span class="input-group-text ms-1" style="max-width: 300px;">Ajtó</span>
        <input type="text" formControlName="door" class="form-control mb-4 ms-1" style="max-width: 300px;">
    </div>

    <div class="form-group">
        <span class="input-group-text ms-1" style="max-width: 300px;">E-mail</span>
        <input type="email" formControlName="email" class="form-control mb-4 ms-1" style="max-width: 300px;">
    </div>

    <div class="d-flex">
        <button class="btn btn-primary mb-2 ms-1 mentesgomb" [disabled]="userDataForm.invalid" (click)="saveData()">
            Mentés
        </button>

        <button class="btn btn-secondary mb-2 ms-1"  (click)="toggleProfile(false); navigateToChangePassword()">
            Jelszó megváltoztatása
        </button>
    </div>
    
</form>

@if(successfullProfilDataChanged){
    <div class="d-flex mt-3 justify-content-center">
        <h1 class="ms-between ms-3">Sikeresen megváltoztattad az adataidat</h1>
        <img src="images/registerSuccessful.png" alt="Sikeres módosítás ikon" class="ms-2" style="width: 50px; height: 50px;">
    </div>
}

@if(errorProfilDataChanged){
    <div class="d-flex mt-3 justify-content-center ms-3 mb-3" [ngClass]="{'error-card': showErrorCard}">
            <strong [innerHTML]="errorMessageFromBackend" id="errorMessageFromBackend" class="mt-2"></strong>
    </div>
}

</div>

}